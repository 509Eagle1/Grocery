<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Albertsons Grocery List</title>
<style>
body {
  font-family: Arial, sans-serif;
  margin: 10px;
  background: #f4f4f4;
}

h1 {
  text-align: center;
  margin-bottom: 5px;
}

.menu {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  margin-bottom: 10px;
}

.menu button, .menu input {
  padding: 5px 8px;
  font-size: 14px;
}

#searchBar {
  flex: 1;
}

#shoppingList {
  list-style-type: none;
  padding-left: 10px;
  margin: 0;
  text-align: left;
}

#shoppingList li {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  text-align: left;
  gap: 8px;
  padding: 6px 8px;
  background: white;
  margin-bottom: 5px;
  border-radius: 6px;
  cursor: grab;
  box-shadow: 0 1px 2px rgba(0,0,0,0.1);
}

#shoppingList li:active {
  cursor: grabbing;
  background: #eaf3ff;
}

#shoppingList li.checked span {
  text-decoration: line-through;
  color: gray;
}

.drag-over {
  border: 2px dashed #007BFF;
}
</style>
</head>
<body>

<h1>Albertsons Grocery List</h1>

<div class="menu">
  <button onclick="clearChecks()">Clear All Checks</button>
  <input type="text" id="searchBar" placeholder="Search items..." onkeyup="searchItems()">
</div>

<ul id="shoppingList"></ul>

<script>
const list = document.getElementById('shoppingList');

// === Load saved list from localStorage or default ===
let groceryItems = JSON.parse(localStorage.getItem('albertsonsList')) || [
  "Milk", "Eggs", "Bread", "Cheese", "Apples", "Bananas", "Butter", "Orange Juice"
];
renderList();

// === Render list items ===
function renderList() {
  list.innerHTML = '';
  groceryItems.forEach(item => {
    const li = document.createElement('li');
    li.setAttribute('draggable', true);
    li.innerHTML = `<input type="checkbox"> <span>${item}</span>`;
    list.appendChild(li);
  });
  addDragEvents();
}

// === Clear all checkboxes ===
function clearChecks() {
  document.querySelectorAll('#shoppingList input[type="checkbox"]').forEach(cb => cb.checked = false);
}

// === Search filter ===
function searchItems() {
  const filter = document.getElementById('searchBar').value.toLowerCase();
  document.querySelectorAll('#shoppingList li').forEach(li => {
    const text = li.textContent.toLowerCase();
    li.style.display = text.includes(filter) ? '' : 'none';
  });
}

// === Drag and Drop Reordering ===
let draggedItem = null;

function addDragEvents() {
  const items = list.querySelectorAll('li');
  items.forEach(li => {
    li.addEventListener('dragstart', e => {
      draggedItem = li;
      setTimeout(() => li.style.display = 'none', 0);
    });

    li.addEventListener('dragend', e => {
      setTimeout(() => {
        li.style.display = '';
        draggedItem = null;
        saveNewOrder();
      }, 0);
    });

    li.addEventListener('dragover', e => e.preventDefault());

    li.addEventListener('dragenter', e => {
      e.preventDefault();
      li.classList.add('drag-over');
    });

    li.addEventListener('dragleave', e => li.classList.remove('drag-over'));

    li.addEventListener('drop', e => {
      li.classList.remove('drag-over');
      if (draggedItem && draggedItem !== li) {
        const itemsArray = Array.from(list.children);
        const draggedIndex = itemsArray.indexOf(draggedItem);
        const droppedIndex = itemsArray.indexOf(li);
        if (draggedIndex < droppedIndex) {
          list.insertBefore(draggedItem, li.nextSibling);
        } else {
          list.insertBefore(draggedItem, li);
        }
      }
    });
  });
}

// === Save new order to localStorage ===
function saveNewOrder() {
  groceryItems = Array.from(list.querySelectorAll('span')).map(span => span.textContent);
  localStorage.setItem('albertsonsList', JSON.stringify(groceryItems));
}
</script>

</body>
</html>
